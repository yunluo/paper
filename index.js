const about = `<!DOCTYPE html>
<html lang="zh-CN">
<head><meta charset="utf-8"><meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport"><link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAQAD/AG8A/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiAAAAAAAiIiIAAAAAACIgIiAAAAACIgAiIRERERIiAAIiEREREiAAAiIREREiIAAAIiAAAiIAAAAiIAACIgAAAAIiACIgAAAAAiIAIiAAAAAAIiIiAAAAAAAiIiIAAAAAAAIiIAAAAAAAAiIgAAAAAAAAIgAAAAAAAAAiAAAAAf+AAAH/gAAI/xAACAAQAAwAMAAMADAADjxwAA48cAAPGPAADxjwAA+B8AAPgfAAD8PwAA/D8AAP5/AAD+fwAA" rel="icon" type="image/x-icon" /><title>关于小纸条的一些说明</title>
    <style>
    *{-webkit-font-smoothing:antialiased;cursor:default!important}body,html{background-color:#fff;font-family:PingFangSC-Light,Nunito,sans-serif;height:100vh;margin:0 8px;line-height:1.75em}img{text-align:center;border-radius:2px;max-width:100%}.shadow{box-shadow:0 2px 3px rgba(0,0,0,.2)}h1{font-size:24px;padding:10px 0 0}h3 {padding: 0;margin: 0;margin-top: 30px;border-top: solid 1px #eee}.author{font-size:12px;color:#999;font-size:14px}.footer{padding:40px 0;text-align:center;color:#ccc}.footer span{border:1px solid #eee;border-radius:2px;padding:2px 8px;font-size:12px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}.body{font-size:15px;padding-top:10px}.article{margin:0 auto;max-width:677px}.center{text-align:center}.full-width{width:100%;max-width:100%}li{line-height:1em}p{line-height:1.75em;margin:4px auto}hr{height:0;border:0;border-top:1px solid #eee}.end{margin-top: 50px}
    </style>
</head>
<body>
<div class="article">
    <h1>关于小纸条的一些说明</h1>
    <div class="author">
        <a>From 云落</a> <span>2022-1-4 10:25:22</span>
    </div>
<hr />
    <div class="body">
<p>本人因为经常到处找云盘资源，有的资源不好找，所以做了个资源导航页面，如果有什么问题的话，在这里面做一些解答</p>
<h3><strong>小纸条里面的资源都是你的吗？</strong></h3>
<p>错的，小纸条不存储任何资源的，你可以把小纸条当成一个资源导航，资源文件本身还是在各位网友的云盘里面的，小纸条本身仅仅是一个15kb大小的html文档</p>
<h3><strong>小纸条里面的资源都是哪里来的？</strong></h3>
<p>网络收集或者其他网友的投稿分享</p>
<h3><strong>我发现有的资源失效了或者上面资源侵犯我的版权了，怎么删除掉？</strong></h3>
<p>小纸条是支持投诉的，直接点击投诉链接，按照要求投诉删除，请点击并提交即可</p>
<h3><strong>小纸条的资源会更新吗？另外更新的话怎么提醒我？</strong></h3>
<p>首先，小纸条的资源主要是有网友投稿的，只要有人投稿那么肯定就会更新的，另外关于资源更新提醒的，小纸条首页有订阅微信的，微信扫码之后关注公众好，如果有资源更新就会微信提醒你的</p>
<h3><strong>小纸条提交的资源都有审查吗？</strong></h3>
<p>没有，只能对一些比较可疑的项目进行查核，其他基本不查的，无他，没空，懒罢了</p>
<h3 id="tggz"><strong>投稿资源有什么规则吗</strong></h3>
<p><strong>首先是不能上传的</strong></p><p>1，<span style="color:#e53333">违法，擦边球，暧昧的</span>咱们肯定是不能传的</p><p>2，还<span style="color:#e53333">没公开上映的资源</span>也是不能上传的，咱不能影响人家做生意</p>
<p><strong>下面是具体的投稿要求</strong></p><p>1，必须是<span style="color:#e53333">永久分享</span>链接，非永久链接可能会删除或者转存重新提交</p><p>2，有<span style="color:#e53333">提取码</span>的或者<span style="color:#e53333">解压码</span>的必须提供，可以放在资源标题或者说明里面，如果放在说明里就必须放在最前面，在后面有可能被程序截取掉</p>
<p>3，标题不能长，简单明了就好，太长页面会显得很乱</p><p>4，如果<span style="color:#e53333">重复资源请不要提交了</span>，影视资源标题和其他要素之间间隔一个<span style="color:#e53333">空格</span>或者一个<span style="color:#e53333">. </span><span>比如 正确的标题是 <span style="background-color:#e53333">指环王 全集</span> 中间有一个空格或者.<span style="background-color:#e53333">指环王.全集</span>，既可以自动查重，也可以查询视频资料</span></p>
<p>ps.影视资源 关键字 后留一个空格或者一个. 程序会自动搜索检查有木有重复的，如果频繁提交重复资源，会被BAN ip的</p>
<p>5，资源如果可以查询资料的，尽量查询资料，这里说的是影视资源</p>
<p>6，资源如果是大合集类型，请在说明里面写入目录，注意：一定要要有<span style="color:#e53333">目录</span>两个字，不然会被截取的</p>
<p>推荐的标题:庆余年 中文版，蜘蛛侠 全集，霍比特人 4K，毒液2 (2021)，大主宰 全集系列</p>
<p>不推荐的标题:[电影][蜘蛛侠][4k][H256][杜比音效][国语配音]</p>
<p><span style="color:#e53333">如上，资源标题最多3个关键词，第一个必须是资源原本名字，第二，第三不做限制，可以写一个主演名字，或者年代，或者码率都可以，比如：天龙八部.胡军.4K，不要在资源名称前面添加任何修饰词，比如：收藏级，全集，强烈推荐，稀缺资源等等</span></p>
<br>
<p align="center"><button style="font-size:20px" onclick="localStorage.setItem('submit_read', 'is_read');this.innerText='OK，您已获得投稿权限'">点击确认后才可以投稿</button></p>
<h3 id="qtlj"><strong>小纸条还有哪些域名</strong></h3>
<p>第一个：<a href="https://u.gitcafe.net" target="_blank" rel="noopener noreferrer"><b>https://u.gitcafe.net</b></a>  [此域名服务器是又拍云CDN，主要推荐这个，又短又快]</p>
<p>第二个：<a href="https://o.gitcafe.net" target="_blank" rel="noopener noreferrer"><b>https://o.gitcafe.net</b></a>  [此域名服务器是阿里云CDN，速度很快，而且和源站同步]</p>
<p>第三个：<a href="http://a.gitcafe.net" target="_blank" rel="noopener noreferrer"><b>http://a.gitcafe.net</b></a>  [此域名服务器是七牛云CDN，这个速度也很好，就是不支持https]</p>
<p>第四个：<a href="https://alipaper.yunluo.workers.dev" target="_blank" rel="noopener noreferrer"><b>https://alipaper.yunluo.workers.dev</b></a> [此域名服务器是cloudfare的CDN，这个速度也很好，尤其是全球访问更好，就是域名有点长]</p>

<br>
<p>以上服务器关系：原始数据在第五个我的服务器上，然后使用微力同步软件同步数据到我家的群晖NAS中，群晖NAS通过CloudSync套件数据同步到阿里云OSS即第二个域名站点，第二个域名服务器得到数据，将数据给第一，第三，第四服务器站点调用，故：第五站点和第二站点其实是关键，如果第二站点和第五站点数据不一致，那么应该是我家NAS断电了或者断网了</p>


<h3><strong>我提交资源到小纸条能得到什么？</strong></h3>
<p>得到阿里云盘用户，小纸条用户的赞美</p>
<p class="end"><strong>未完待续</strong></p>
</div>
</div>
<div class="footer">
    <span>POWERED BY 小纸条 2021-2022</span>
</div>
<script>
!function(){
    if(localStorage.getItem('submit_read') == 'is_read' ){
        document.getElementsByTagName('button')[0].innerText='OK，您已获得投稿权限';
    }
}(); 
</script>
</body>
</html>`
const lib = `<script src="https://u.gitcafe.net/assets/js/libs.js"></script>
    <script>
    cities = new Array;
    cities['电视'] = Array('华语电视', '日韩电视', '欧美电视', '其他电视');
    cities['电影'] = Array('华语电影', '日韩电影', '欧美电影', '其他电影');
    cities['动漫'] = Array('华语动漫', '日韩动漫', '欧美动漫');
    cities['视频'] = Array('纪录片', '综艺片', '教育培训', '其他视频');
    cities['音乐'] = Array('华语音乐', '日韩音乐', '欧美音乐', '其他音乐');
    cities['软件'] = Array('娱乐软件', '系统软件', '网络软件', '办公软件', '其他软件');
    cities['文档'] = Array('漫画', '小说', '出版书', '知识培训', '其他文档');
    cities['图片'] = Array('壁纸', '人物', '风景', '其他图片');
    cities['其他'] = Array('其他');

    function set_cat(province, cat) {
        var pv, cv, i, ii;
        pv = province.value;
        cv = cat.value;
        cat.length = 1;
        if (pv == '0') return;
        if (typeof(cities[pv]) == 'undefined') return;
        for (i = 0; i < cities[pv].length; i++) {
            ii = i + 1;
            cat.options[ii] = new Option();
            cat.options[ii].text = cities[pv][i];
            cat.options[ii].value = cities[pv][i];
        }
    }
    //分类代码转化
    function cat_code(a) {
        var b, c, d = [ "华语电视", "日韩电视", "欧美电视", "其他电视", "华语电影", "日韩电影", "欧美电影", "其他电影", "华语动漫", "日韩动漫", "欧美动漫", "纪录片", "综艺片", "教育培训", "其他视频", "华语音乐", "日韩音乐", "欧美音乐", "其他音乐", "娱乐软件", "系统软件", "网络软件", "办公软件", "其他软件", "漫画", "小说", "出版书", "知识培训", "其他文档", "壁纸", "人物", "风景", "其他图片", "其他" ], e = [ "hyds", "rhds", "omds", "qtds", "hydy", "rhdy", "omdy", "qtdy", "hydm", "rhdm", "omdm", "jlp", "zyp", "jypx", "qtsp", "hyyy", "rhyy", "omyy", "qtyy", "kfrj", "xtrj", "wlrj", "bgrj", "qtrj", "mh", "xs", "cbs", "zspx", "qtwd", "bz", "rw", "fj", "qttp", "qt" ];
        if (/^[a-zA-Z]+$/.test(a)) {
            for (b = 0, c = d.length; c > b; b++) if (e[b] == a) return d[b];
        } else{ 
            for (b = 0, c = e.length; c > b; b++) if (d[b] == a) return e[b];
        }
    }

    Zepto(function($) {
        var api = 'https://gitcafe.net/tool/alipaper/';

        /* 自动填充密码*/
        !function() {
            $("#token").length > 0 && setTimeout(function() {
                $("#token").attr("value", localStorage.getItem("alipaper_token"));
            }, 100);

            $("#mail").length > 0 && setTimeout(function() {
                $("#mail").attr("value", localStorage.getItem("alipaper_mail"));
            }, 100);

            $("#cat_name").length > 0 && $("#cat_name").text(cat_code($("#cat_name").attr('class')));

            if($("#mykey").length > 0){//我的投稿页面

                var mykey = "";
                yuxStorage.keys().then(function(keys) {
                    keys.forEach(function(key){
                        yuxStorage.getItem(key).then(v => {
                            $("#mykey").append("<tr><td>" + v[0] + "</td><td><a target='_blank' href='https://www.aliyundrive.com/s/" + key + "'>" + key + "</a></td><td title='" + v[3] + "'>" + v[1] + "</td><td><a class='tousu' target='_blank' href='https://alipaper.yunluo.workers.dev/tousu?id=" + key + "&cat=" + cat_code(v[2]) + "&title=" + v[1] + "' title='若此资源无效或违规，请投诉'>投诉</a><span> 丨 </span><a class='update' target='_blank' href='https://alipaper.yunluo.workers.dev/update?id=" + key + "&cat=" + cat_code(v[2]) + "&title=" + v[1] + "&des=" + v[3] + "' title='资源管理员可以更新'>更新</a></td></tr>");
                        });
                        
                    });

                });

            }

        }();

        $(".vote").click(function(){
            var ajax_data = {
                action:'vote',
                cat:$(this).data('cat'),
                key:$(this).data('key'),
                vote:$(this).data('vote')
            }
            if (localStorage.getItem('my_vote') == ajax_data.key) {
                swal('投票失败', '您已投票，请勿重复投票', 'error');
				return;
            }else{
                $.post(api,ajax_data,function(c){
                    c = $.trim(c);
                    if(c =='200'){
                        localStorage.setItem('my_vote', ajax_data.key);
                        swal('系统提示','您的投票已成功，小纸条因你而精彩！','success');
                    }else{
                        swal('系统提示',c,'error');
                    }
                })
            }
        })

        $("#contact").click(function(){
            var ajax_data = {
                action:'contact',
                text:$('#text').val()
            }
            $.post(api,ajax_data,function(c){
                c = $.trim(c);
                if(c =='200'){
                    swal('系统提示','您的信息已推送至管理员微信','success');
                }else{
                    swal('系统提示',c,'error');
                }
            })
        })

        $("#title").change(function(){
            var ajax_data = {
                action:'CheckRepeat',
                title :$('#title').val()
            }
            $.post(api,ajax_data,function(c){
                 c = $.trim(c);
                 if( c =='400'){
                     $("#search_res").empty();
                     $("#search_res").html('<p class="search_info" style="color:green">您的资源目前小纸条尚未收录，请放心提交</p>');
                 }else{
                     $("#search_res").empty();
                     $("#search_res").html('<p class="search_info" style="color:red">您的资源貌似已经有收录了哦，需要审核通过才可以展示哦</p>');
                 }
            })
        })

        $("#key").change(function(){
            var url = $.trim($('#key').val()).length;
                 if( parseInt(url) > 42){
                     $(".err_info").empty();
                     $("#key").after('<p class="err_info" style="color:red">请检查您的分享链接，系统发现异常，疑似混入提取码</p>');
                    }else{
                        $(".err_info").empty();
                    }
                
        })

        $("#dbid").click(function() {
            var ajax_data = {
                action: 'tmdb',
                title: $('#title').val()
            };
            $.post(api, ajax_data, function(c) {
                c = $.trim(c);
                var g = document.createElement("div"),
                    f = c.split('|'); /**使用|风格e,分为数组f */
                    g.innerHTML = '<img src="'+f[4]+'"><p>【'+f[0]+'】【'+f[1]+'】【'+f[2]+'】'+f[3]+'</p>';
                if (c == '400') {
                    swal('信息查询失败', '1，请确保是影视作品才可以查询信息;2，请确保标题没有其他多余内容', 'error');
					return;
                } else {
                    swal("请核对视频信息", {
                        content: g,
                        buttons: true,
                        dangerMode: true,
                    }).then((infok) => {
                        if (infok) {
                            $("#des").text('['+f[2]+']'+f[3]);
                        }
                    });
                }
            });
        });

            $("#tougao").click(function() {
                    var ajax_data = {
                        action: 'submit',
                        title: $.trim($('#title').val()),
                        cat: $('#cat').val(),
                        des: $.trim($('#des').val()),
                        key: $.trim($('#key').val()),
                        mail: $.trim($('#mail').val()),
                        token: $.trim($('#token').val()),
                    };
                    var long = (new Date().getTime() - localStorage.getItem('tougao_time'))/1000;
                    
                if (localStorage.getItem('my_submit') == ajax_data.key) {
                    swal('提交失败', '稍等，请勿重复提交', 'error');
					return;
                }else{
                    if (localStorage.getItem('submit_read') == 'is_read') {
                        if ( long > 120 ) {
                        $.post(api, ajax_data, function(c) {
                            c = $.trim(c);
                            if (c !== '200') {
                                swal('提交失败', c, 'error');
                            } else {
                                swal('提交成功', '您的投稿已提交，小纸条因你而精彩！', 'success');
                                localStorage.setItem('my_submit', ajax_data.key);
                                localStorage.setItem('alipaper_token', ajax_data.token);
                                localStorage.setItem('alipaper_mail', ajax_data.mail);
                                localStorage.setItem('tougao_time', new Date().getTime());
                                yuxStorage.setItem(ajax_data.key.replace('https://www.aliyundrive.com/s/',''), [new Date().getMonth()+1 +'/'+ new Date().getDate(),ajax_data.title,ajax_data.cat,ajax_data.des])
                            }
                        });
                        }else{
                            swal('提交失败', '投稿技能冷却中，离下次投稿时间还有'+ Math.ceil(120-long) +'秒', 'warning');
                        }
                    }else{
                        swal('提交失败', '请先查看投稿规则，然后再投稿资源，谢谢合作',  "warning", {
                            button: "好的，我去瞅瞅看",
                            dangerMode: true
                        }).then((value) => {
                            window.open("https://alipaper.yunluo.workers.dev/about#tggz");
                        });
                    }
                }

            });

        $("#tgall").click(function() {
            var ajax_data = {
                action: 'tgall',
                cat: $('#cat').val(),
                keys: $('#keys').val(),
                token: $('#token').val(),
            };
            $.post(api, ajax_data, function(c) {
                c = $.trim(c);
                if (c !== '200') {
                    swal('提交失败', c, 'error');
                } else {
                    swal('提交成功', '您的投稿资源将推送到微信订阅', 'success');
                    localStorage.setItem('alipaper_token', ajax_data.token);
                }
            });
        });

        $("#update").click(function() {
            var ajax_data = {
                action: 'update',
                title: $('#title').val(),
                old_cat: $(this).data('cat'),/*原来分类*/
                new_cat: $('#cat').val(),/*现在分类*/
                des: $('#des').val(),
                key: $('#key').val(),
                token: $('#token').val(),
            };
            $.post(api, ajax_data, function(c) {
                c = $.trim(c);
                if (c !== '200') {
                    swal('提交失败', c, 'error');
                } else {
                    swal('提交成功', '您的资源更新已成功，小纸条因你而精彩！', 'success');
                }
            });
        });

        $("#liyou").change(function() {
            var liyou = $("#liyou").val();
            if (liyou == 'delme') {
                $("#key_des").before('<div class="key_token row"><div class="column">资源管理密钥<span class="red">*</span><input type="number" placeholder="请输入正确的密钥" id="token"></div></div>');
                $('#token').attr('value', localStorage.getItem("alipaper_token"));
            } else if (liyou == '资源有侵犯版权问题') {
                $("#key_des").before('<div class="right_info row"><div class="column">版权(法)人名字<span class="red">*</span><input type="text" placeholder="请输入版权所有者名字" id="right_user"></div><div class="column">版权作品名称<span class="red">*</span><input type="text" placeholder="请输入版权作品名称" id="right_name"></div></div>');

            } else {
                if ($("#token").length > 0) {
                    $(".key_token").remove();
                }
                if ($("#right_user").length > 0) {
                    $(".right_info").remove();
                }
            }
        });

        $("#tousu").click(function() {
            $(this).addClass('disable');
            var ajax_data = {
                action: 'tousu',
                key: $('#key').val(),
                cat: $(this).data('cat'),
                token: $('#token').val(),
                title: $('#title').val(),
				right_user: $.trim($('#right_user').val()),
				right_name: $.trim($('#right_name').val()),
                desx: $('#desx').val(),
                liyou: $('#liyou').val(),
                des: $('#des').val()
            };
			if( ajax_data.liyou == '资源有侵犯版权问题'){
				if(ajax_data.right_user == '' || ajax_data.right_name ==''){
					swal('提交失败', '投诉版权侵权，请输入输入正确的版权信息，谢谢合作', 'error');
					return;
				}
			}
            if (localStorage.getItem('my_tousu') == ajax_data.key) {
                swal('提交失败', '稍等，请勿重复提交', 'error');
				return;
            }else{
                $.post(api, ajax_data, function(c) {
                    $(this).removeClass('disable');
                    c = $.trim(c);
                    if (c !== '200') {
                        swal('提交失败', c, 'error');
                    } else {
                        if (ajax_data.liyou == 'delme') {
                            swal('删除成功', '您的资源已删除成功', 'success');
                        } else {
                            localStorage.setItem('my_tousu', ajax_data.key);
                            swal('投诉成功', '已通知管理员处理投诉，小纸条因你而精彩！', 'success');
                        }
                    }
                });
            }
        });

        $("#delete").click(function() {
            var ajax_data = {
                action: 'del',
                key: $('#key').val(),
                cat: $(this).data('cat')
            };
            $.post(api, ajax_data, function(c) {
                c = $.trim(c);
                if (c !== '200') {
                    swal('删除失败', c, 'error');
                } else {
                    swal('删除成功', '已成功删除被投诉的资源', 'success');
                }
            });
        });
    })
            /** 统计代码 **/
        window.onload = function() {
            var t = document.createElement("script");
            t.src = "https://v1.cnzz.com/z_stat.php?id=1280771259&web_id=1280771259", document.getElementsByTagName("body")[0].appendChild(t);
        };
    </script>
</body>
</html>`

const contact =`<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>联系中心</title>
    <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAQAD/AG8A/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiAAAAAAAiIiIAAAAAACIgIiAAAAACIgAiIRERERIiAAIiEREREiAAAiIREREiIAAAIiAAAiIAAAAiIAACIgAAAAIiACIgAAAAAiIAIiAAAAAAIiIiAAAAAAAiIiIAAAAAAAIiIAAAAAAAAiIgAAAAAAAAIgAAAAAAAAAiAAAAAf+AAAH/gAAI/xAACAAQAAwAMAAMADAADjxwAA48cAAPGPAADxjwAA+B8AAPgfAAD8PwAA/D8AAP5/AAD+fwAA" rel="icon" type="image/x-icon" />
    <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/normalize/8.0.1/normalize.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/milligram/1.4.1/milligram.min.css">
    <style>.red{color:red}.swal-button{line-height:normal}h1{margin-top:25px;}h1{margin-top:25px;}.center,h1,h4{text-align:center}form{display:inline}</style>
</head>
<body>
    <main class="wrapper">
        <div class="container">
            <h1><a href="">联系中心</a></h1>
            在这里输入发给管理员的信息，这里会直接推送到管理员微信，如有需要，可以留下你的联系方式
            <div class="row">
                <div class="column">
                    <textarea style="height:100px" placeholder="请在此输入您的信息" id="text"></textarea>
                </div>
            </div>
            <div class="row">
                <div class="column">
                <select id="way">
                <option value="0">请选择联系方式</option>
                <option value="QQ">QQ</option>
                <option value="wechat">微信</option>
                <option value="email">邮箱</option>
            </select>
            <input type="text" placeholder="请留下你的联系方式，必要的话，我会联系你的" id="mail" required>
                </div>
            </div>
            <a style="display: block;" class="button" id="contact" href="javascript:;">提交</a>
            </div>
    </main>`


    const mykey =`<!DOCTYPE html>
    <html lang="zh-cn">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>我的投稿中心</title>
        <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAQAD/AG8A/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiAAAAAAAiIiIAAAAAACIgIiAAAAACIgAiIRERERIiAAIiEREREiAAAiIREREiIAAAIiAAAiIAAAAiIAACIgAAAAIiACIgAAAAAiIAIiAAAAAAIiIiAAAAAAAiIiIAAAAAAAIiIAAAAAAAAiIgAAAAAAAAIgAAAAAAAAAiAAAAAf+AAAH/gAAI/xAACAAQAAwAMAAMADAADjxwAA48cAAPGPAADxjwAA+B8AAPgfAAD8PwAA/D8AAP5/AAD+fwAA" rel="icon" type="image/x-icon" />
        <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/normalize/8.0.1/normalize.min.css" rel="stylesheet"/>
        <link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/milligram/1.4.1/milligram.min.css">
        <style>.red{color:red}.swal-button{line-height:normal}h1{margin-top:25px;}h1{margin-top:25px;}.center,h1,h4{text-align:center}form{display:inline}</style>
    </head>
    <body>
        <main class="wrapper">
            <div class="container">
                <h1><a href="">我的投稿</a></h1>
                <p>请注意：以下记录为浏览器本地记录，服务器无记录，本地数据库存储，一般清除浏览器缓存不会清除数据</p>
                <hr>
                <table width="100%">
                <thead>
                    <tr><th width="20%">日期</th><th width="20%">链接</th><th width="40%">标题</th><th width="20%">操作</th></tr>
                </thead>
                <tbody id="mykey"></tbody>
                </table>
            </div>
        </main>`

const tougao = `<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小纸条资源提交中心</title>
    <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAQAD/AG8A/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiAAAAAAAiIiIAAAAAACIgIiAAAAACIgAiIRERERIiAAIiEREREiAAAiIREREiIAAAIiAAAiIAAAAiIAACIgAAAAIiACIgAAAAAiIAIiAAAAAAIiIiAAAAAAAiIiIAAAAAAAIiIAAAAAAAAiIgAAAAAAAAIgAAAAAAAAAiAAAAAf+AAAH/gAAI/xAACAAQAAwAMAAMADAADjxwAA48cAAPGPAADxjwAA+B8AAPgfAAD8PwAA/D8AAP5/AAD+fwAA" rel="icon" type="image/x-icon" />
    <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/normalize/8.0.1/normalize.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/milligram/1.4.1/milligram.min.css">
    <style>.red{color:red}.swal-button{line-height:normal}h1{margin-top:25px;}.center,h1,h4{text-align:center}form{display:inline}</style>
</head>
<body>
    <main class="wrapper">
        <div class="container">
            <h1><a href="">小纸条资源提交中心</a></h1>
            资源标题<span class="red">*</span>(可直接粘贴口令) <a target="_blank" class="red" href="https://alipaper.yunluo.workers.dev/about#tggz">投稿必看</a>
            <div class="row">
                <div class="column">
                    <input type="text"
                        oninput="value=value.replace('「阿里云盘」','').replace(/(.+「|「)/s,'').replace(/」.+/s,'').replace(/https.+/s,'').substr(0,20)"
                        placeholder="用一句话简单说明你的资源，最多20个文字哦~" id="title" required>
                </div>
            </div>
            <div id="search_res"></div>
            资源链接<span class="red">*</span>(可直接粘贴口令)
            <div class="row">
                <div class="column">
                    <input type="url" oninput="value=value.replace(/.+https/s,'https').replace(/ 点击.+/s,'').replace(/folder.+/s,'')" placeholder="请不要输入链接以外的内容，注意不要把提取码混入里面哦" id="key" required>
                </div>
            </div>
            资源信息<span class="red">*</span>
            <div class="row">
                <div class="column">
                    <form>
                        <select name="province" onChange="set_cat(this, this.form.cat);">
                            <option value="0">选择一级分类</option>
                            <option value="电视">电视</option>
                            <option value="电影">电影</option>
                            <option value="动漫">动漫</option>
                            <option value="视频">视频</option>
                            <option value="音乐">音乐</option>
                            <option value="软件">软件</option>
                            <option value="文档">文档</option>
                            <option value="图片">图片</option>
                            <option value="其他">其他</option>
                        </select>
                </div>
                <div class="column">
                    <select name="cat" id="cat">
                        <option value="0">选择二级分类</option>
                    </select>
                    </form>
                </div>
            </div>
            资源说明 <a class="button" id="dbid" href="javascript:;">获取信息</a>
            <div class="row">
                <div class="column">
                    <textarea placeholder="请详细说明下文件内容" id="des"></textarea>
                </div>
            </div>
            <div class="row">
                <div class="column">
                    我的邮箱<span class="red">*</span>
                    <input type="email" placeholder="请输入邮箱，必须是可用的，用来发送资源失效，资源投诉等通知邮件" id="mail" required>
                </div>
            </div>
            <div class="row">
                <div class="column">
                    管理密钥<span class="red">*</span>
                    <input type="number" placeholder="资源管理密钥，可以更新和删除资源，仅支持纯数字" id="token" required>
                </div>
            </div>
            <a style="display: block;" class="button" id="tougao" href="javascript:;">提交</a>
            </div>
    </main>`

    const tgall = `<!DOCTYPE html>
    <html lang="zh-cn">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>小纸条资源提交中心</title>
        <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAQAD/AG8A/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiAAAAAAAiIiIAAAAAACIgIiAAAAACIgAiIRERERIiAAIiEREREiAAAiIREREiIAAAIiAAAiIAAAAiIAACIgAAAAIiACIgAAAAAiIAIiAAAAAAIiIiAAAAAAAiIiIAAAAAAAIiIAAAAAAAAiIgAAAAAAAAIgAAAAAAAAAiAAAAAf+AAAH/gAAI/xAACAAQAAwAMAAMADAADjxwAA48cAAPGPAADxjwAA+B8AAPgfAAD8PwAA/D8AAP5/AAD+fwAA" rel="icon" type="image/x-icon" />
        <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/normalize/8.0.1/normalize.min.css" rel="stylesheet"/>
        <link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/milligram/1.4.1/milligram.min.css">
        <style>.red{color:red}.swal-button{line-height:normal}h1{margin-top:25px;}.center,h1,h4{text-align:center}form{display:inline}</style>
    </head>
    <body>
        <main class="wrapper">
            <div class="container">
                <h1><a href="">小纸条资源提交中心</a></h1>
                请先选择分类<a target="_blank" style="color:red;" href="https://alipaper.yunluo.workers.dev/about#tggz">批量投稿必看</a>
                <div class="row">
                    <div class="column">
                        <form>
                            <select name="province" onChange="set_cat(this, this.form.cat);">
                                <option value="0">选择一级分类</option>
                                <option value="电视">电视</option>
                                <option value="电影">电影</option>
                                <option value="动漫">动漫</option>
                                <option value="视频">视频</option>
                                <option value="音乐">音乐</option>
                                <option value="软件">软件</option>
                                <option value="文档">文档</option>
                                <option value="图片">图片</option>
                                <option value="其他">其他</option>
                            </select>
                    </div>
                    <div class="column">
                        <select name="cat" id="cat">
                            <option value="0">选择二级分类</option>
                        </select>
                        </form>
                    </div>
                </div>
                资源批量提交
                <div class="row">
                    <div class="column">
                        <textarea style="height:350px" placeholder="请在此输入您的资源标题和链接，最多同时导入20个，采用小白杨客户端复制格式，如下：\n标题\n链接：分享链接" id="keys"></textarea>
                    </div>
                </div>
                <div class="row">
                    <div class="column">
                        管理密钥
                        <input type="number" placeholder="资源管理密钥，可以更新和删除资源，仅支持纯数字" id="token" required>
                    </div>
                </div>
                <a style="display: block;" class="button" id="tgall" href="javascript:;">提交</a>
                </div>
        </main>`

    async function handleRequest(request) {
      const url = new URL(request.url);
      let key = url.searchParams.get("id");
      let title = url.searchParams.get("title");
      let des = url.searchParams.get("des");
      let cat = url.searchParams.get("cat");
      let mail = url.searchParams.get("mail");
      let html = null;

let deletekey = `<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小纸条资源删除中心</title>
    <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAQAD/AG8A/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiAAAAAAAiIiIAAAAAACIgIiAAAAACIgAiIRERERIiAAIiEREREiAAAiIREREiIAAAIiAAAiIAAAAiIAACIgAAAAIiACIgAAAAAiIAIiAAAAAAIiIiAAAAAAAiIiIAAAAAAAIiIAAAAAAAAiIgAAAAAAAAIgAAAAAAAAAiAAAAAf+AAAH/gAAI/xAACAAQAAwAMAAMADAADjxwAA48cAAPGPAADxjwAA+B8AAPgfAAD8PwAA/D8AAP5/AAD+fwAA" rel="icon" type="image/x-icon" />
    <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/normalize/8.0.1/normalize.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/milligram/1.4.1/milligram.min.css">
    <style>.red{color:red}.swal-button{line-height:normal}h1{margin-top:25px;}.center,h1,h4{text-align:center}form{display:inline}</style>
</head>
<body>
    <main class="wrapper">
        <div class="container">
            <h1><a href="">小纸条资源删除中心</a></h1>
            资源链接
            <div class="row">
                <div class="column">
                    <input type="text" disabled value="${key}" id="key">
                </div>
            </div>
            资源名
            <div class="row">
                <div class="column">
                    <input type="text" disabled value="${title}" id="title">
                </div>
            </div>
            <a style="display: block;" class="button button-outline" href="https://www.aliyundrive.com/s/${key}">立刻查看</a>
            <a style="display: block;" class="button" id="delete" data-cat="${cat}" href="javascript:;">删除</a>
            </div>
    </main>`

let vote =`<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>资源投票中心</title>
    <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAQAD/AG8A/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiAAAAAAAiIiIAAAAAACIgIiAAAAACIgAiIRERERIiAAIiEREREiAAAiIREREiIAAAIiAAAiIAAAAiIAACIgAAAAIiACIgAAAAAiIAIiAAAAAAIiIiAAAAAAAiIiIAAAAAAAIiIAAAAAAAAiIgAAAAAAAAIgAAAAAAAAAiAAAAAf+AAAH/gAAI/xAACAAQAAwAMAAMADAADjxwAA48cAAPGPAADxjwAA+B8AAPgfAAD8PwAA/D8AAP5/AAD+fwAA" rel="icon" type="image/x-icon" />
    <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/normalize/8.0.1/normalize.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/milligram/1.4.1/milligram.min.css">
    <style>.red{color:red}.swal-button{line-height:normal}h1{margin-top:25px;}h1{margin-top:25px;}.center,h1,h4{text-align:center}form{display:inline}</style>
</head>
<body>
    <main class="wrapper">
        <div class="container">
            <h1><a href="">投票中心</a></h1>
            
            <div class="row">
                资源名： <a target="_blank" href="https://www.aliyundrive.com/s/${key}">${title}</a>
            </div>
            <br><br>
            <div class="row">
                <div class="column">
                    <a style="display: block;" class="button vote" data-key="${key}" data-cat="${cat}" data-vote="1" href="javascript:;">👍资源不错，顶一下</a>
                </div>
                <div class="column">
                    <a style="display: block;" class="button button-outline vote" data-key="${key}" data-cat="${cat}" data-vote="-1" href="javascript:;">👎不行啊，踩一下</a>
                </div>
            </div>
            </div>
    </main>`

let tousu = `<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小纸条资源投诉中心</title>
    <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAQAD/AG8A/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiAAAAAAAiIiIAAAAAACIgIiAAAAACIgAiIRERERIiAAIiEREREiAAAiIREREiIAAAIiAAAiIAAAAiIAACIgAAAAIiACIgAAAAAiIAIiAAAAAAIiIiAAAAAAAiIiIAAAAAAAIiIAAAAAAAAiIgAAAAAAAAIgAAAAAAAAAiAAAAAf+AAAH/gAAI/xAACAAQAAwAMAAMADAADjxwAA48cAAPGPAADxjwAA+B8AAPgfAAD8PwAA/D8AAP5/AAD+fwAA" rel="icon" type="image/x-icon" />
    <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/normalize/8.0.1/normalize.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/milligram/1.4.1/milligram.min.css">
    <style>.disable{pointer-events:none}.red{color:red}.swal-button{line-height:normal}h1{margin-top:25px;}.center,h1,h4{text-align:center}form{display:inline}</style>
</head>
<body>
    <main class="wrapper">
        <div class="container">
            <h1><a href="">小纸条资源投诉中心</a></h1>
            资源链接
            <div class="row">
                <div class="column">
                    <input type="text" disabled value="${key}" id="key">
                </div>
            </div>
            资源名
            <div class="row">
                <div class="column">
                    <input type="text" disabled value="${title}" id="title">
                </div>
            </div>
            资源说明
            <div class="row">
                <div class="column">
                    <textarea disabled id="desx">${des}</textarea>
                </div>
            </div>
            投诉理由<span class="red">*</span>
            <div class="row">
                <div class="column">
                    <form>
                        <select id="liyou">
                            <option value="0">选择投诉原因</option>
                            <option value="delme">资源提供者自主删除</option>
                            <option value="资源空白或者已失效">资源空白或者已失效</option>
                            <option value="资源有侵犯版权问题">资源有侵犯版权问题</option>
                            <option value="标题与实际文件不符">标题与实际文件不符</option>
                            <option value="资源重复或不是永久">资源重复或不是永久</option>
                            <option value="其他原因">其他原因</option>
                        </select>
                    </form>
                </div>
            </div>
            <span id="key_des">具体说明</span>
            <div class="row">
                <div class="column">
                    <textarea placeholder="请详细说明下投诉原因，写清楚当然更方便处理问题" id="des"></textarea>
                </div>
            </div>
            <a style="display: block;" class="button" id="tousu" data-cat="${cat}" href="javascript:;">提交</a>
            </div>
    </main>`

let update = `<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小纸条资源更新中心</title>
    <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAQAD/AG8A/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiAAAAAAAiIiIAAAAAACIgIiAAAAACIgAiIRERERIiAAIiEREREiAAAiIREREiIAAAIiAAAiIAAAAiIAACIgAAAAIiACIgAAAAAiIAIiAAAAAAIiIiAAAAAAAiIiIAAAAAAAIiIAAAAAAAAiIgAAAAAAAAIgAAAAAAAAAiAAAAAf+AAAH/gAAI/xAACAAQAAwAMAAMADAADjxwAA48cAAPGPAADxjwAA+B8AAPgfAAD8PwAA/D8AAP5/AAD+fwAA" rel="icon" type="image/x-icon" />
    <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/normalize/8.0.1/normalize.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/milligram/1.4.1/milligram.min.css">
    <style>.red{color:red}.swal-button{line-height:normal}h1{margin-top:25px;}.center,h1,h4{text-align:center}form{display:inline}</style>
</head>
<body>
    <main class="wrapper">
        <div class="container">
            <h1><a href="">小纸条资源更新中心</a></h1>
            <div class="row">
                <div class="column">
                    资源链接
                    <input type="text" value="${key}" id="key" disabled>
                </div>
                <div class="column">
                    管理密钥
                    <input type="number" placeholder="请输入正确的管理密钥，空或者错误无法更新" id="token" required>
                </div>
            </div>
            资源标题
            <div class="row">
                <div class="column">
                    <input type="text" oninput="value=value.substr(0,20)" value="${title}" id="title" required>
                </div>
            </div>
            资源信息[当前为：<span class="${cat}" id="cat_name"></span>]
            <div class="row">
                <div class="column">
                    <form>
                        <select name="province" onChange="set_cat(this, this.form.cat);">
                            <option value="0">选择一级分类</option>
                            <option value="电视">电视</option>
                            <option value="电影">电影</option>
                            <option value="动漫">动漫</option>
                            <option value="视频">视频</option>
                            <option value="音乐">音乐</option>
                            <option value="软件">软件</option>
                            <option value="文档">文档</option>
                            <option value="图片">图片</option>
                            <option value="其他">其他</option>
                        </select>
                </div>
                <div class="column">
                    <select name="cat" id="cat">
                        <option value="0">选择二级分类</option>
                    </select>
                    </form>
                </div>
            </div>
            资源说明<a class="button" id="dbid" href="javascript:;">获取信息</a>
            <div class="row">
                <div class="column">
                    <textarea placeholder="请详细说明下文件内容" id="des" oninput="value=value.replace(/.+名称/s,'').replace(/(\d{4}-\d{2}-\d{2}.+|\d{4}-\d{2}-\d{2}|folder|text|others|没有更多了|.+必须看.+|\/|^\r|\n\r|\n$)/g,'')">${des}</textarea>
                </div>
            </div>
            <a style="display: block;" class="button" id="update" data-cat="${cat}" href="javascript:;">提交</a>
            </div>
    </main>`
    let err = `<p>Access Denied</p>`

  if (url.pathname.startsWith("/tougao")){
        html = tougao + lib
  }else if(url.pathname.startsWith("/tgall")){
        html = tgall + lib
  }else if(url.pathname.startsWith("/tousu")){
      if( key == "" ){
        html = err
      } else {
        html = tousu + lib
      }
  }else if(url.pathname.startsWith("/update")){
      if( key == "" ){
        html = err
      } else {
        html = update + lib
      }
  }else if(url.pathname.startsWith("/about")){
        html = about
  }else if(url.pathname.startsWith("/mykey")){
        html = mykey + lib
  }else if(url.pathname.startsWith("/contact")){
        html = contact + lib
  }else if(url.pathname.startsWith("/vote")){
        html = vote + lib
  }else if(url.pathname.startsWith("/delete")){
    if( key == "" ){
        html = err
      } else {
        html = deletekey + lib
      }
  }else{
        html = `<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="robots" content="index,follow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="theme-color" content="#ffb549">
    <meta name="application-name" content="小纸条-开放纯粹的资源网站">
    <meta name="color-scheme" content="dark light">
    <title>小纸条-开放纯粹的资源网站</title>
    <link href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAKlBMVEUAAADSZDfSZDfryaDSZDe0RjLrh0u/UTTWaTpLP07///9dU2BaT13ryaCZFnJdAAAABHRSTlMAzPl3IDm31QAAAAFiS0dECmjQ9FYAAAAHdElNRQfmAgUJCiJhiWOMAAAAbUlEQVQI12NgcGAAAhYgDhEA0q5ARqgLA4NLKIgR4pbmCmKUeqSlpYUDGSpuQEYKkOGSBgJIDBaXWWlpq9MSGFjcZqelzQEyXNzSIHJ3715LS8u9e5eB+e61zG25dw2A2kAMBjAAmwICvBeABAC90CPadJikOwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0wMi0wNVQwNjoxMDozNCswMzowMCU/+JYAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMDItMDVUMDY6MTA6MzQrMDM6MDBUYkAqAAAAAElFTkSuQmCC" rel="icon" />
    <style>*{font-family:"Microsoft YaHei";}.center,h1,h4{text-align:center}.right{float:right;display:block}table.GeneratedTable{width:100%;background-color:#fff;border-collapse:collapse;border:2px solid #ffb549;color:#000}table.GeneratedTable td,table.GeneratedTable th{border:2px solid #ffb549;padding:3px}table.GeneratedTable thead{background-color:#ffb549}.tableizer-table td,table.tableizer-table{border:1px solid #ccc}.tableizer-table td{padding:4px;margin:3px}.tableizer-title{background-color:#104e8b;color:#fff;font-weight:700}a{text-decoration:none}.tableizer-title a{color:#fff}.msg{background: #eb4646;color:#fff;font-weight: 700;text-align: center;position: -webkit-sticky;position: sticky;padding: 3px;top: 0px;z-index:1;}.cat{background-color:#ffeead;font-weight:700;text-align:center;position:-webkit-sticky;position:sticky;padding:10px;top:0;z-index:1}css-icon{background-color:#1cad70;color:#eb4646;display:inline-block;height:1em;width:1em;font-size:30px;box-sizing:border-box;text-indent:-9999px;vertical-align:middle;position:relative}css-icon:after,css-icon:before{content:"";box-sizing:inherit;position:absolute;left:50%;top:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.icon-upward:before{height:.65em;width:.65em;border-style:solid;border-width:2px 0 0 2px;-ms-transform:translate(-50%,-50%) rotate(45deg);transform:translate(-50%,-50%) rotate(45deg)}.icon-upward:after{height:.8em;border-left:2px solid;top:55%}#TopBtn{bottom:45px;right:15px;position:fixed;z-index:99}.GeneratedTable tbody tr:hover{background-color:#eee}.ui-button{padding:10px 15px;border:0;border-radius:4px;background-color:#0078e7;color:#fff;font-size:.875rem}.button-success{background:#1cb841}.button-error{background:#ca3c3c}.button-warning{background:#df7514}.button-secondary{background:#42b8dd}.allkey>tr>td:first-child{width:30%!important}[tooltip]{position:relative}[tooltip]:after,[tooltip]:before{text-transform:none;font-size:.9em;line-height:1.5;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none;position:absolute;display:none;opacity:0}[tooltip]:before{content:"";border:5px solid transparent;z-index:1001}[tooltip]:after{content:attr(tooltip);text-align:left;width:20em;padding:1ch 1.5ch;border-radius:.3ch;box-shadow:0 1em 2em -.5em rgba(0,0,0,.35);background:#000;color:#fff;z-index:1000}[tooltip]:hover:after,[tooltip]:hover:before{display:block}[tooltip=""]:after,[tooltip=""]:before{display:none!important}[tooltip]:not([flow]):before{bottom:100%;border-bottom-width:0;border-top-color:#000}[tooltip]:not([flow]):after{bottom:calc(100% + 5px)}[tooltip]:not([flow]):after,[tooltip]:not([flow]):before{left:50%;-webkit-transform:translate(-50%,-.5em);transform:translate(-50%,-.5em)}@-webkit-keyframes tooltips-vert{to{opacity:.9;-webkit-transform:translate(-50%);transform:translate(-50%)}}@keyframes tooltips-vert{to{opacity:.9;-webkit-transform:translate(-50%);transform:translate(-50%)}}[tooltip]:not([flow]):hover:after,[tooltip]:not([flow]):hover:before{-webkit-animation:tooltips-vert .15s ease-out forwards;animation:tooltips-vert .15s ease-out forwards}input{box-sizing:border-box;padding-left:50px;height:40px;outline:0;border:1px solid #666;border-radius:4px;color:#4c5161;font-size:14px;transition:border-color .2s,background-color .2s;-webkit-appearance:none}hr{color:#666;font-size:15px;font-weight:400;line-height:1.5;overflow:visible;text-align:inherit;margin:0 0 20px;border:0;border-top:1px solid #e5e5e5}.link_head{line-height:1.4;color:inherit}.subtitle{position:relative;color:#4c5161;height:45px;line-height:45px;text-align:center}.subtitle:before{left:2%}.subtitle:after,.subtitle:before{content:"";position:absolute;width:30%;height:1px;top:50%;background-color:#a2a9b6}.subtitle:after{right:2%}@media (max-width:40rem){.m_hide{display:none;}.right{float:none}.allkey [tooltip]:not([flow])::after,.allkey [tooltip]:not([flow])::before {left: 90%;}}</style>
    <style id="theme-options-filter"></style>
</head>
<body>
        <div align="center"><img src="data:image/png;base64,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"></div>
    <h1 style="margin-top: 0px;"><a class="link_head" href="">小纸条</a></h1>
    <div class="center"> <a tooltip="你可以把你的资源投稿到小纸条，在打开后的页面中填写好表单即可" style="margin-right:30px;" class="ui-button button-success" href="https://alipaper.yunluo.workers.dev/tougao" target="_blank">投稿资源</a><a tooltip="实际上是腾讯图个槽，作为一个简单的交流区，顺便做吐槽平台" style="margin-right:30px;" href="https://support.qq.com/products/375895/#label=show" target="_blank" class="ui-button button-error">交流区</a><a tooltip="打开后用微信扫码关注一个公众号，这个是用来推送微信信息的，如果小纸条有资源更新的话，会通过这个公众号发信息提醒你的，强烈建议关注" class="ui-button" href="https://wxpusher.zjiecode.com/api/qrcode/Cc6DWeaxRzCYuBo5QuRavfJ486tELdDHmi5zUqixOgmvxM2yRcpYOPOqYUJ92120.jpg" target="_blank">微信订阅</a> </div>
    <div class="center" style="border:1px dashed #f00;margin: 30px 10px;padding: 20px;">
        <input type="search" placeholder="在此输入搜索内容…" id="wp-filter-search-input" class="wp-filter-search">
        <h4>当前共收录 <span class="all_num"></span> 个资源</h4>
    </div>
    <h2 class="navh2 subtitle">资源导航</h2>
    <table class="tableizer-table key_nav " style="table-layout: fixed;" width="100%">
        <tbody>
            <tr>
                <td class="tableizer-title"><a id="ds_nav" href="#hyds">电视</a></td>
                <td><a onclick="load_data('hyds');" href="javascript:;">华语</a><span class="hyds_num right"></span></td>
                <td><a onclick="load_data('rhds');" href="javascript:;">日韩</a><span class="rhds_num right"></span></td>
                <td><a onclick="load_data('omds');" href="javascript:;">欧美</a><span class="omds_num right"></span></td>
                <td><a onclick="load_data('qtds');" href="javascript:;">其他</a><span class="qtds_num right"></span></td>
            </tr>
            <tr>
                <td class="tableizer-title"><a id="dy_nav" href="#hydy">电影</a></td>
                <td><a onclick="load_data('hydy');" href="javascript:;">华语</a><span class="hydy_num right"></span></td>
                <td><a onclick="load_data('rhdy');" href="javascript:;">日韩</a><span class="rhdy_num right"></span></td>
                <td><a onclick="load_data('omdy');" href="javascript:;">欧美</a><span class="omdy_num right"></span></td>
                <td><a onclick="load_data('qtdy');" href="javascript:;">其他</a><span class="qtdy_num right"></span></td>
            </tr>
            <tr>
                <td class="tableizer-title"><a id="dm_nav" href="#hydm">动漫</a></td>
                <td><a onclick="load_data('hydm');" href="javascript:;">国漫</a><span class="hydm_num right"></span></td>
                <td><a onclick="load_data('rhdm');" href="javascript:;">日本</a><span class="rhdm_num right"></span></td>
                <td><a onclick="load_data('omdm');" href="javascript:;">欧美</a><span class="omdm_num right"></span></td>
            </tr>
            <tr>
                <td class="tableizer-title"><a id="sp_nav" href="#jlp">视频</a></td>
                <td><a onclick="load_data('jlp');" href="javascript:;">纪录</a><span class="jlp_num right"></span></td>
                <td><a onclick="load_data('zyp');" href="javascript:;">综艺</a><span class="zyp_num right"></span></td>
                <td><a onclick="load_data('jypx');" href="javascript:;">教育</a><span class="jypx_num right"></span></td>
                <td><a onclick="load_data('qtsp');" href="javascript:;">其他</a><span class="qtsp_num right"></span></td>
            </tr>
            <tr>
                <td class="tableizer-title"><a href="#hyyy">音乐</a></td>
                <td><a onclick="load_data('hyyy');" href="javascript:;">华语</a><span class="hyyy_num right"></span></td>
                <td><a onclick="load_data('rhyy');" href="javascript:;">日韩</a><span class="rhyy_num right"></span></td>
                <td><a onclick="load_data('omyy');" href="javascript:;">欧美</a><span class="omyy_num right"></span></td>
                <td><a onclick="load_data('qtyy');" href="javascript:;">其他</a><span class="qtyy_num right"></span></td>
            </tr>
            <tr>
                <td class="tableizer-title"><a href="#kfrj">软件</a></td>
                <td><a onclick="load_data('kfrj');" href="javascript:;">娱乐</a><span class="kfrj_num right"></span></td>
                <td><a onclick="load_data('xtrj');" href="javascript:;">系统</a><span class="xtrj_num right"></span></td>
                <td><a onclick="load_data('wlrj');" href="javascript:;">网络</a><span class="wlrj_num right"></span></td>
                <td><a onclick="load_data('bgrj');" href="javascript:;">办公</a><span class="bgrj_num right"></span></td>
            </tr>
            <tr>
                <td class="tableizer-title"><a href="#mh">文档</a></td>
                <td><a onclick="load_data('mh');" href="javascript:;">漫画</a><span class="mh_num right"></span></td>
                <td><a onclick="load_data('xs');" href="javascript:;">小说</a><span class="xs_num right"></span></td>
                <td><a onclick="load_data('cbs');" href="javascript:;">出版</a><span class="cbs_num right"></span></td>
                <td><a onclick="load_data('zspx');" href="javascript:;">知识</a><span class="zspx_num right"></span></td>
            </tr>
            <tr>
                <td class="tableizer-title"><a href="#bz">图片</a></td>
                <td><a onclick="load_data('bz');" href="javascript:;">壁纸</a><span class="bz_num right"></span></td>
                <td><a onclick="load_data('rw');" href="javascript:;">人物</a><span class="rw_num right"></span></td>
                <td><a onclick="load_data('fj');" href="javascript:;">风景</a><span class="fj_num right"></span></td>
                <td><a onclick="load_data('qttp');" href="javascript:;">其他</a><span class="qttp_num right"></span></td>
            </tr>
            <tr>
                <td class="tableizer-title"><a href="#qt">其它</a></td>
                <td><a onclick="load_data('qt');" href="javascript:;">其他</a><span class="qt_num right"></span></td>
                <td><a onclick="load_data('qtrj');" href="javascript:;">其他软件</a><span class="qtrj_num right"></span></td>
                <td><a onclick="load_data('qtwd');" href="javascript:;">其他文档</a><span class="qtwd_num right"></span></td>
            </tr>
        </tbody>
    </table>
    <h2 class="newh2 subtitle">最近更新</h2>
    <table style="table-layout: fixed;" width="100%" class="GeneratedTable new">
        <thead>
            <tr class="tableizer-firstrow">
                <th width="15%">日期</th>
                <th width="55%">标题</th>
                <th width="30%">链接</th>
            </tr>
        </thead>
        <tbody id="newkey"></tbody>
    </table>
    <h2 class="toph2 subtitle">置顶推荐</h2>
    <table style="table-layout: fixed;" width="100%" class="GeneratedTable top">
        <thead>
            <tr class="tableizer-firstrow">
                <th width="40%">标题</th>
                <th width="20%">链接</th>
                <th width="40%">理由</th>
            </tr>
        </thead>
        <tbody id="topkey" class="allkey"></tbody>
    </table>
    <h2 class="subtitle">资源列表</h2>
    <table style="table-layout: fixed;" width="100%" class="GeneratedTable list">
        <thead>
            <tr class="tableizer-firstrow">
                <th width="45%">标题</th>
                <th width="33%">链接</th>
                <th width="22%">操作</th>
            </tr>
        </thead>
        <tbody id="keylist" class="allkey"></tbody>
    </table>
    <div class="center">
        <p><a target="_blank" href="https://alipaper.yunluo.workers.dev/about">关于</a></p>
        <p>
        <a target="_blank" href="http://googlome.mikecrm.com/4UfbOU2">发我私信</a> //
        <a target="_blank" href="https://alipaper.yunluo.workers.dev/mykey">我的投稿</a> //
        <a title="点击此处，可清空缓存" style="cursor:help;" onclick="localStorage.clear();alert('缓存已清空');" href="javascript:;">系统缓存</a>
        </p>
    </div>
    <span id="TopBtn"><a href="#">
            <css-icon class="icon-upward"></css-icon>
        </a></span>
    <script>
const get_cookie = n => ("; " + document.cookie).split("; " + n + "=").pop().split(";").shift();
        
const set_cookie = (e, t, o) => document.cookie = e + "=" + t + ";sameSite=Lax;expires=" + new Date(Date.now() + 36e5 * o);

const nowtime  = new Date().getTime();

//设立缓存，时间小时
const ls_set =(k,v,t) => {
	    const obj = {
        time: Date.now() + t*360e4, //时间单位H，1000*3600
        data: v, //存储值
    };
    localStorage.setItem(k, JSON.stringify(obj));
}

//获取缓存
const ls_get = (k) => {
  if (!localStorage.getItem(k)) return undefined;
  const { time, data } = JSON.parse(localStorage.getItem(k));
  if (time < Date.now()) {
    localStorage.removeItem(k);
    return undefined;
  }
  return data;
};

//判断空
const isEmpty = (t) => {
    return "" === t || ("null" === t || ("undefined" === t || (!t && 0 !== t && "" !== t || (!(!Array.prototype.isPrototypeOf(t) || 0 !== t.length) || (!(!Object.prototype.isPrototypeOf(t) || 0 !== Object.keys(t).length) || "{}" === JSON.stringify(t))))));
}

//输出投票
const get_vote = (k) => {
  if (isEmpty(k) || k == 0) return "";
  if( k < 0 ){
      return "👎("+ Math.abs(k)+")";
  }else{
      if(k < 500){
        return "👍("+ k +")";
      }else{
        return "👍(500+)";
      }
  }
  
};
//分类代码转化
const cat_code = (a) => {
    var d, e, b = [ "华语电视", "日韩电视", "欧美电视", "其他电视", "华语电影", "日韩电影", "欧美电影", "其他电影", "华语动漫", "日韩动漫", "欧美动漫", "纪录片", "综艺片", "教育培训", "其他视频", "华语音乐", "日韩音乐", "欧美音乐", "其他音乐", "娱乐软件", "系统软件", "网络软件", "办公软件", "其他软件", "漫画", "小说", "出版书", "知识培训", "其他文档", "壁纸", "人物", "风景", "其他图片", "其他" ], c = [ "hyds", "rhds", "omds", "qtds", "hydy", "rhdy", "omdy", "qtdy", "hydm", "rhdm", "omdm", "jlp", "zyp", "jypx", "qtsp", "hyyy", "rhyy", "omyy", "qtyy", "kfrj", "xtrj", "wlrj", "bgrj", "qtrj", "mh", "xs", "cbs", "zspx", "qtwd", "bz", "rw", "fj", "qttp", "qt" ];
    for (d = 0, e = c.length; e > d; d++) if (c[d] == a) return b[d];
}
//描述
const des_mb = (a) => isEmpty(a) ? "" :a.substring(0, 200);

//点击加载分类数据
const load_data = (e) =>{
    if (isEmpty(ls_get(e + "_data"))) {
        fetch("https://gitcafe.net/alipaper/data/" + e + ".json?v=" + nowtime)
            .then(response => response.json())
            .then(data => {
                console.log('Fetch api');
                var $json = document.getElementById("keylist"), json = "";
                /**分类列表*/
                json += '<tr><td class="cat" colspan="3"><a id="' + data.info.code + '">' + data.info.name + "</a></td></tr>";
                for (let j = 0, v = data.data, lens = v.length; j < lens; j++) {
                    json += '<tr><td class="key_' + v[j].key + '" tooltip="' + des_mb(v[j].des) + '">' + get_vote(v[j].vote) + v[j].title + '</td><td><a target="_blank" href="https://www.aliyundrive.com/s/' + v[j].key + '">' + v[j].key + '</a></td><td><a class="tousu" target="_blank" href="https://alipaper.yunluo.workers.dev/tousu?id=' + v[j].key + "&cat=" + v[j].cat + "&title=" + v[j].title + "&des=" + des_mb(v[j].des) + '" title="若此资源无效或违规，请投诉"><span class="m_hide">投</span>诉</a><span> | </span><a class="update" target="_blank" href="https://alipaper.yunluo.workers.dev/update?id=' + v[j].key + "&cat=" + v[j].cat + "&title=" + v[j].title + "&des=" + des_mb(v[j].des) + '" title="资源管理员可以更新"><span class="m_hide">更</span>新</a><span> | </span><a class="vote" target="_blank" href="https://alipaper.yunluo.workers.dev/vote?id=' + v[j].key + "&cat=" + v[j].cat + "&title=" + v[j].title + '" title="可以对资源进行评价哦">评<span class="m_hide">价</span></a></td></tr>';
                }
                $json.innerHTML = json;
                window.location.hash = "#" + e;
                /*加入缓存*/
                ls_set(e + '_data', json, 3);
            })
            .catch(error => console.error('Error:', error));
    } else {
        console.log('Cache api');
        document.getElementById("keylist").innerHTML = ls_get(e + '_data');
        window.location.hash = "#" + e;
    }
};

//开始执行
(function () {
    var all_num = get_cookie("all_num"), cats_num = ls_get("cats_num"), cat_num = {};
    var cat_arr = ['hyds', 'rhds', 'omds', 'qtds', 'hydy', 'rhdy', 'omdy', 'qtdy', 'hydm', 'rhdm', 'omdm', 'jlp', 'zyp', 'jypx', 'qtsp', 'hyyy', 'rhyy', 'omyy', 'qtyy', 'kfrj', 'xtrj', 'wlrj', 'bgrj', 'qtrj', 'mh', 'xs', 'cbs', 'zspx', 'qtwd', 'bz', 'rw', 'fj', 'qttp', 'qt'];
    document.getElementsByClassName("all_num")[0].innerText = all_num;

    for (var i = 0, len = cat_arr.length; i < len; i++) {
        if (!isEmpty(cats_num)) {
            document.getElementsByClassName(cat_arr[i] + "_num")[0].innerText = cats_num[cat_arr[i]];
        }
    }
    /*请求数据*/
    if (isEmpty(ls_get("new_data")) || isEmpty(ls_get("home_data"))) {
        fetch("https://gitcafe.net/alipaper/home.json?v=" + nowtime)
            .then(response => response.json())
            .then(data => {
                var $json = document.getElementById("keylist"), $new = document.getElementById("newkey"), $top = document.getElementById("topkey"),
                    json = "", newkey = "" ,topkey = "";
                isEmpty(all_num) && (document.getElementsByClassName("all_num")[0].innerText = data.info.key_num,
                set_cookie("all_num", data.info.key_num, 3));

                /* 最新列表 */
                for (let i = 0, k = data.info.new, len = k.length; i < len; i++) {
                    newkey += "<tr><td>" + k[i].date + '</td><td tooltip="' + des_mb(k[i].des) + '">【' + cat_code(k[i].cat) + "】" + k[i].title + '</td><td><a target="_blank" href="https://www.aliyundrive.com/s/' + k[i].key + '">' + k[i].key + "</a></td></tr>";
                }
                $new.innerHTML = newkey;
                ls_set("new_data", newkey, 1);

                /* 置顶推荐 */
                for (let i = 0, k = data.info.top, len = k.length; i < len; i++) {
                    topkey += "<tr><td tooltip='" + des_mb(k[i].des) + "'>" + k[i].title + "</td><td><a target='_blank' href='https://www.aliyundrive.com/s/" + k[i].key + "'>打开链接</a></td><td>" + k[i].why + "</td></tr>";
                }
                $top.innerHTML = topkey;
                ls_set("top_data", topkey, 1);
                /**分类列表*/
                for (let i = 0, k = data.data, len = k.length; i < len; i++) {
                    if (isEmpty(cats_num)) {
                        document.getElementsByClassName(k[i].info.code + "_num")[0].innerText = k[i].info.cat_num;
                        cat_num[k[i].info.code] = k[i].info.cat_num;
                    }
                    json += '<tr><td class="cat" colspan="3"><a name="' + k[i].info.code + '">' + k[i].info.name + "</a></td></tr>";
                    for (let j = 0, v = k[i].data, lens = v.length; j < lens; j++) {
                        json += '<tr><td class="key_' + v[j].key + '" tooltip="' + des_mb(v[j].des) + '">' + get_vote(v[j].vote) + v[j].title + '</td><td><a target="_blank" href="https://www.aliyundrive.com/s/' + v[j].key + '">' + v[j].key + '</a></td><td><a class="tousu" target="_blank" href="https://alipaper.yunluo.workers.dev/tousu?id=' + v[j].key + "&cat=" + v[j].cat + "&title=" + v[j].title + "&des=" + des_mb(v[j].des) + '" title="若此资源无效或违规，请投诉"><span class="m_hide">投</span>诉</a><span> | </span><a class="update" target="_blank" href="https://alipaper.yunluo.workers.dev/update?id=' + v[j].key + "&cat=" + v[j].cat + "&title=" + v[j].title + "&des=" + des_mb(v[j].des) + '" title="资源管理员可以更新"><span class="m_hide">更</span>新</a><span> | </span><a class="vote" target="_blank" href="https://alipaper.yunluo.workers.dev/vote?id=' + v[j].key + "&cat=" + v[j].cat + "&title=" + v[j].title + '" title="可以对资源进行评价哦">评<span class="m_hide">价</span></a></td></tr>';
                    }
                }

                $json.innerHTML = json;
                ls_set("home_data", json, 1);
                set_cookie("alert_token_new", data.info.alert_token, 99999);
                set_cookie("alert_msg", data.info.msg, 99999);
                isEmpty(cats_num) && ls_set("cats_num", cat_num, 3);
            })
            .catch(error => console.error('Error:', error));
    } else {
        document.getElementById("newkey").innerHTML = ls_get("new_data");
        document.getElementById("topkey").innerHTML = ls_get("top_data");
        document.getElementById("keylist").innerHTML = ls_get("home_data");
    }

    isEmpty(get_cookie("alert_token")) && get_cookie("alert_token") != get_cookie("alert_token_new") && (document.getElementsByTagName("body")[0].insertAdjacentHTML("beforeBegin", "<div class='msg'>" + get_cookie("alert_msg") + "<a style='float:right' id='closeit' href='javascript:;'>×</a>  </div>"),
        document.getElementById("closeit").onclick = function () {
            document.getElementsByClassName("msg")[0].remove(), set_cookie("alert_token", get_cookie("alert_token_new"), 99999);
        })

}()) //结束

/** 站内搜索功能 */
var themeOptionsFilter = document.getElementById("theme-options-filter"), wpFilterSearchInput = document.getElementById("wp-filter-search-input"), searchtxt = '';
wpFilterSearchInput.addEventListener("focus", function () {
    if (isEmpty(ls_get("all_json"))) {
            fetch("https://gitcafe.net/alipaper/all.json?v=" + nowtime)
            .then(response => response.json())
            .then(data => {
            console.log('focus Fetch Api');
            ls_set('all_json', data, 1);
            })
            .catch(error => console.error('Error:', error));
    }
                
})
wpFilterSearchInput.addEventListener("input", function () {
    themeOptionsFilter.innerText = ".key_nav,.new,.top,.toph2,.navh2,.newh2{display:none}";
    if (isEmpty(wpFilterSearchInput.value)) {
        themeOptionsFilter.innerText = "";
        document.getElementById("keylist").innerHTML = ls_get("home_data");
    } else {
        if (isEmpty(ls_get("all_json"))) {
            fetch("https://gitcafe.net/alipaper/all.json?v=" + nowtime)
                .then(response => response.json())
                .then(data => {
                console.log('Search Fetch Api');
                for (let c = 0, d = data.data, lens = d.length; c < lens; c++) {
                    if ( d[c].title.trim().toLowerCase().search(wpFilterSearchInput.value.trim().toLowerCase()) != -1 || d[c].des.trim().toLowerCase().search(wpFilterSearchInput.value.trim().toLowerCase()) != -1) {
                        searchtxt += '<tr><td class="key_' + d[c].key + '" tooltip="' + des_mb(d[c].des) + '">【' + cat_code(d[c].cat) + '】' + get_vote(d[c].vote) + d[c].title + '</td><td><a target="_blank" href="https://www.aliyundrive.com/s/' + d[c].key + '">' + d[c].key + '</a></td><td><a class="tousu" target="_blank" href="https://alipaper.yunluo.workers.dev/tousu?id=' + d[c].key + "&cat=" + d[c].cat + "&title=" + d[c].title + "&des=" + des_mb(d[c].des) + '" title="若此资源无效或违规，请投诉"><span class="m_hide">投</span>诉</a><span> | </span><a class="update" target="_blank" href="https://alipaper.yunluo.workers.dev/update?id=' + d[c].key + "&cat=" + d[c].cat + "&title=" + d[c].title + "&des=" + des_mb(d[c].des) + '" title="资源管理员可以更新"><span class="m_hide">更</span>新</a><span> | </span><a class="vote" target="_blank" href="https://alipaper.yunluo.workers.dev/vote?id=' + d[c].key + "&cat=" + d[c].cat + "&title=" + d[c].title + '" title="可以对资源进行评价哦">评<span class="m_hide">价</span></a></td></tr>';
                        
                    }
                }
                    document.getElementById("keylist").innerHTML = searchtxt;
                    ls_set('all_json', data, 1);
                    searchtxt = '';
                })
                .catch(error => console.error('Error:', error));
        }else{
            console.log('Search Cache Api');
            for (let j = 0, v = ls_get("all_json").data, lens = v.length; j < lens; j++) {
                if (v[j].title.trim().toLowerCase().search(wpFilterSearchInput.value.trim().toLowerCase()) != -1 || v[j].des.trim().toLowerCase().search(wpFilterSearchInput.value.trim().toLowerCase()) != -1) {
                    searchtxt += '<tr><td class="key_' + v[j].key + '" tooltip="' + des_mb(v[j].des) + '">【' + cat_code(v[j].cat) + '】' + get_vote(v[j].vote) + v[j].title + '</td><td><a target="_blank" href="https://www.aliyundrive.com/s/' + v[j].key + '">' + v[j].key + '</a></td><td><a class="tousu" target="_blank" href="https://alipaper.yunluo.workers.dev/tousu?id=' + v[j].key + "&cat=" + v[j].cat + "&title=" + v[j].title + "&des=" + des_mb(v[j].des) + '" title="若此资源无效或违规，请投诉"><span class="m_hide">投</span>诉</a><span> | </span><a class="update" target="_blank" href="https://alipaper.yunluo.workers.dev/update?id=' + v[j].key + "&cat=" + v[j].cat + "&title=" + v[j].title + "&des=" + des_mb(v[j].des) + '" title="资源管理员可以更新"><span class="m_hide">更</span>新</a><span> | </span><a class="vote" target="_blank" href="https://alipaper.yunluo.workers.dev/vote?id=' + v[j].key + "&cat=" + v[j].cat + "&title=" + v[j].title + '" title="可以对资源进行评价哦">评<span class="m_hide">价</span></a></td></tr>';
                }
            }
            document.getElementById("keylist").innerHTML = searchtxt;
            searchtxt = '';
        }

    }

});

//加载完毕执行
window.onload = function () {
    /** 统计代码 **/
    var t = document.createElement("script");
    t.src = "https://v1.cnzz.com/z_stat.php?id=1280771259&web_id=1280771259", document.getElementsByTagName("body")[0].appendChild(t);

};
//滑动执行
window.onscroll = function () {
    var e = document.getElementById("keylist").offsetTop, t = document.documentElement.scrollTop, o = e - t, n = document.getElementsByClassName("msg");
    n.length > 0 && (n[0].style.position = o < -1800 ? "relative" : "sticky");
};
    </script>
</body>
</html>`
  }

  return new Response(html, {
    headers: {
      "content-type": "text/html;charset=UTF-8",
    },
  })
}

addEventListener("fetch", event => {
  return event.respondWith(handleRequest(event.request))
})
